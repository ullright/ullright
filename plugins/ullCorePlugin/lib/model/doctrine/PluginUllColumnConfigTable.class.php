<?php
/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PluginUllColumnConfigTable extends UllRecordTable
{

  public static function findForTableAndColumn($table, $column)
  {
    $q = new Doctrine_Query;
    $q->from('UllColumnConfig cc')
      ->where('cc.db_table_name = ?', $table)
      ->addWhere('cc.db_column_name = ?', $column)
    ;
    return  $q->execute()->getFirst();        
  }
  
  public static function getColumnConfigArray($table, $column)
  {
    $columnConfig = array();
    $i18n = false;
    
    if (strstr($column, '_translation_'))
    {
      $i18n = true;
      
      $parts = explode('_', $column);
      $culture = array_pop($parts);
      array_pop($parts);
      $column = implode('_', $parts);      
    }
    
    $dbColumnConfig = self::findForTableAndColumn($table, $column);
    
    if ($dbColumnConfig)
    {
      if ($value = $dbColumnConfig->label)
      {
//        if ($i18n)
//        {
//          $columnConfig['label'] = __('%1% translation %2%', array('%1%' => $value, '%2%' => $culture), 'common');
//        }
//        else
//        {
          $columnConfig['label'] = $value;
//        }
      }
      
      if (!$dbColumnConfig->enabled)
      {
        $columnConfig['access'] = false;
      }
      
      if (!$dbColumnConfig->show_in_list)
      {
        $columnConfig['show_in_list'] = false;
      }
      
      if ($value = $dbColumnConfig->UllColumnType->class)
      {
        $columnConfig['metaWidget'] = $value;
      }
    }
    return $columnConfig;
  }
  
}